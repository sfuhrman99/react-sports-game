var audioBuffer=null;window.AudioContext=window.AudioContext||window.webkitAudioContext;var audioContext=null;var source;var deferredPrompt;function play(url){if(audioContext==null){audioContext=new AudioContext();}
var request=new XMLHttpRequest();if(source){try{source.stop();}catch(err){}}
source=audioContext.createBufferSource();source.connect(audioContext.destination);request.open('GET',url,true);request.responseType='arraybuffer';request.onload=function(){audioContext.decodeAudioData(request.response,function(buffer){source.buffer=buffer;source.start(0);});}
request.send();}
function share(url){url=new URL(url);url.searchParams.set('utm_source','webshare_api');url.searchParams.set('utm_medium','share');if(navigator.share){navigator.share({url:url,title:getTitle(),}).then(()=>ga('send','event','share','webshare_api_success',url.toString())).catch((error)=>ga('send','event','error','webshare_api_error',url.toString()));}else{shareFacebook(url);ga('send','event','error','webshare_api_not_supported',url.toString());}}
async function shareAudioMessage(audio_url,fallback_function,fallback_url){let file=await fetch(audio_url).then(r=>r.blob()).then(blobFile=>new File([blobFile],"myinstants.mp3",{type:"audio/mp3"}));if(navigator.canShare&&navigator.canShare({files:[file]})){navigator.share({files:[file],title:getTitle(),text:'Find more sounds at www.myinstants.com',}).then(()=>ga('send','event','share','webshare_api_audio_success',fallback_url)).catch((error)=>ga('send','event','error','webshare_api_audio_error',fallback_url));}else{fallback_function(fallback_url);ga('send','event','error','webshare_api_audio_not_supported');}}
function shareFacebook(url){url=new URL(url);url.searchParams.set('utm_source','facebook');url.searchParams.set('utm_medium','share');window.open(`https://www.facebook.com/dialog/share?app_id=429381653766621&href=${encodeURIComponent(url)}`)
ga('send','event','share','facebook',url.toString());}
function shareWhatsapp(url){url=new URL(url);url.searchParams.set('utm_source','whatsapp');url.searchParams.set('utm_medium','share');window.open(`https://api.whatsapp.com/send?text=${encodeURIComponent(url)}`);ga('send','event','share','whatsapp',url.toString());return false;}
function shareTwitter(url,title){url=new URL(url);url.searchParams.set('utm_source','twitter');url.searchParams.set('utm_medium','share');window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(title)}&url=${encodeURIComponent(url)}&via=myinstants`,'_blank');ga('send','event','share','twitter',url.toString());return false;}
function shareTelegram(url,title){url=new URL(url);url.searchParams.set('utm_source','telegram');url.searchParams.set('utm_medium','share');window.open(`https://telegram.me/share/url?url=${encodeURIComponent(url)}&text=${encodeURIComponent(title)}`,'_blank');ga('send','event','share','telegram',url.toString());return false;}
function shareReddit(url,title){url=new URL(url);url.searchParams.set('utm_source','reddit');url.searchParams.set('utm_medium','share');window.open(`https://reddit.com/submit?url=${encodeURIComponent(url)}&title=${encodeURIComponent(title)}`,'_blank');ga('send','event','share','reddit',url.toString());return false;}
function sharePinterest(url){url=new URL(url);url.searchParams.set('utm_source','pinterest');url.searchParams.set('utm_medium','share');window.open(`http://pinterest.com/pin/create/button/?url=${encodeURIComponent(url)}`,'_blank');ga('send','event','share','pinterest',url.toString());return false;}
function shareMessenger(url){url=new URL(url);url.searchParams.set('utm_source','messenger');url.searchParams.set('utm_medium','share');window.open(`fb-messenger://share?link=${encodeURIComponent(url)}&app_id=429381653766621`,'_blank');ga('send','event','share','messenger',url.toString());return false;}
function copyLink(url){var dummy=document.createElement('input');document.body.appendChild(dummy);var url=new URL(url);url.searchParams.set('utm_source','copy');url.searchParams.set('utm_medium','share');dummy.value=url;dummy.select();document.execCommand('copy');document.body.removeChild(dummy);ga('send','event','share','copy_link',url.toString());M.toast({html:'URL copied to the clipboard!'});return false;}
function copyEmbed(){var textarea=document.getElementById('instant-embed');textarea.select();document.execCommand('copy');ga('send','event','embed','click',window.location);M.toast({html:'Copied to the clipboard!'});return false;}
function getTitle(){return document.querySelector("meta[property='og:title']").getAttribute("content")||document.title;}
function chromeInstall(){ga('send','event','ChromeInstall','chrome-install');chrome.webstore.install();}
window.addEventListener('load',function(){var elems=document.querySelectorAll('.sidenav');M.Sidenav.init(elems);});document.addEventListener('DOMContentLoaded',function(){var btnAddDesktop=document.getElementById("install-app-desktop");var btnAddMobile=document.getElementById("install-app-mobile");var btnAddInstantPage=document.getElementById("install-app-instant-page");if(navigator.standalone||window.matchMedia('(display-mode: standalone)').matches){btnAddDesktop.style.display='none';btnAddMobile.style.display='none';if(btnAddInstantPage){btnAddInstantPage.style.display='none';}}
window.addEventListener('beforeinstallprompt',function(e){e.preventDefault();deferredPrompt=e;if(!(navigator.standalone||window.matchMedia('(display-mode: standalone)').matches)){btnAddDesktop.removeAttribute('disabled');btnAddMobile.removeAttribute('disabled')
if(btnAddInstantPage){btnAddInstantPage.removeAttribute('disabled')}}
return false;});window.addEventListener('appinstalled',(event)=>{ga('send','event','WebAppInstall','installed_total');});btnAddDesktop.addEventListener('click',(e)=>{install('desktop');});btnAddMobile.addEventListener('click',(e)=>{install('mobile');});if(btnAddInstantPage){btnAddInstantPage.addEventListener('click',(e)=>{install('instant_page');});}});function install(platform){deferredPrompt.prompt();deferredPrompt.userChoice.then((choiceResult)=>{if(choiceResult.outcome==='accepted'){ga('send','event','WebAppInstall','installed_banner_'+platform);}else{ga('send','event','WebAppInstall','dismissed_banner_'+platform);}
deferredPrompt=null;});}